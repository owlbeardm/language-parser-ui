"use strict";(self.webpackChunklanguage_parser_ui=self.webpackChunklanguage_parser_ui||[]).push([[578],{2578:(R,m,c)=>{c.r(m),c.d(m,{CategoryEvolutionComponent:()=>G});var u=c(5042),s=c(4341),g=c(177),e=c(3953),d=c(5680);function h(a,r){if(1&a&&(e.j41(0,"option",2),e.EFF(1),e.k0s()),2&a){const n=r.$implicit;e.Y8G("ngValue",n),e.R7$(),e.JRh(n.name)}}function F(a,r){if(1&a){const n=e.RV6();e.j41(0,"span")(1,"select",1),e.bIt("ngModelChange",function(o){e.eBV(n);const l=e.XpG();return e.Njj(l.changeValueTo({value:o}))}),e.mxI("ngModelChange",function(o){e.eBV(n);const l=e.XpG();return e.DH7(l.valueToModel,o)||(l.valueToModel=o),e.Njj(o)}),e.j41(2,"option",2),e.EFF(3,"---nothing---"),e.k0s(),e.DNE(4,h,2,2,"option",3),e.k0s(),e.j41(5,"a",4),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.save())}),e.EFF(6,"[s]"),e.k0s(),e.j41(7,"a",5),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.edit=!1)}),e.EFF(8,"[c]"),e.k0s()()}if(2&a){const n=e.XpG();e.R7$(),e.R50("ngModel",n.valueToModel),e.R7$(),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",n.valuesTo)}}function v(a,r){if(1&a&&(e.j41(0,"span",8),e.EFF(1),e.k0s()),2&a){const n=e.XpG(2);e.R7$(),e.JRh(n.valueTo.name)}}function T(a,r){1&a&&(e.j41(0,"span",9),e.EFF(1,"no evolution"),e.k0s())}function f(a,r){if(1&a){const n=e.RV6();e.j41(0,"span"),e.DNE(1,v,2,1,"span",6)(2,T,2,0,"span",7),e.j41(3,"a",5),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.startEdit())}),e.EFF(4,"[e]"),e.k0s()()}if(2&a){const n=e.XpG();e.R7$(),e.Y8G("ngIf",n.valueTo),e.R7$(),e.Y8G("ngIf",!n.valueTo)}}let C=(()=>{class a{languagesEvolutionService;langFrom;langTo;pos;valueFrom;valuesTo;valueTo;connectionId;valueToModel;edit=!1;constructor(n){this.languagesEvolutionService=n}ngOnInit(){this.reloadValueTo()}reloadValueTo(){this.langFrom?.id&&this.langTo?.id&&this.pos?.id&&this.valueFrom?.id&&this.languagesEvolutionService.getGrammaticalValueEvolution({langFromId:this.langFrom?.id,langToId:this.langTo?.id,posId:this.pos?.id,valueFromId:this.valueFrom?.id}).subscribe(n=>{this.valueTo=n?.valueTo,this.connectionId=n?.id})}changeValueTo(n){}startEdit(){if(this.valueTo){this.valuesTo||(this.valuesTo=[]);const n=this.valuesTo.find(t=>t.name=this.valueTo?.name);n?this.valueToModel=n:(this.valuesTo.push(this.valueTo),this.valueToModel=this.valueTo)}else this.valueToModel=void 0;this.edit=!0}save(){if(!this.valueToModel&&this.connectionId)this.languagesEvolutionService.removeGrammaticalValueEvolution({id:this.connectionId}).subscribe(()=>{this.edit=!1,this.reloadValueTo()});else{if(!this.valueToModel&&!this.connectionId)return;this.languagesEvolutionService.saveGrammaticalValueEvolution({body:{valueTo:this.valueToModel,valueFrom:this.valueFrom,languageFrom:this.langFrom,languageTo:this.langTo,pos:this.pos}}).subscribe(t=>{this.connectionId=t,this.edit=!1,this.reloadValueTo()})}}static \u0275fac=function(t){return new(t||a)(e.rXU(d.e))};static \u0275cmp=e.VBU({type:a,selectors:[["app-category-evolution-input"]],inputs:{langFrom:"langFrom",langTo:"langTo",pos:"pos",valueFrom:"valueFrom",valuesTo:"valuesTo"},standalone:!0,features:[e.aNF],decls:2,vars:2,consts:[[4,"ngIf"],["id","languageSelector","name","languageSelector",1,"languageSelector",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-green-dull","link-btn",2,"margin-left","8px",3,"click"],[1,"text-grey-dull","link-btn",2,"margin-left","4px",3,"click"],["class","text-green-dull",4,"ngIf"],["class","text-red-dull",4,"ngIf"],[1,"text-green-dull"],[1,"text-red-dull"]],template:function(t,o){1&t&&e.DNE(0,F,9,3,"span",0)(1,f,5,2,"span",0),2&t&&(e.Y8G("ngIf",o.edit),e.R7$(),e.Y8G("ngIf",!o.edit))},dependencies:[s.YN,s.xH,s.y7,s.wz,s.BC,s.vS,g.bT]})}return a})();var _=c(4378),E=c(9407),y=c(6419);function j(a,r){if(1&a&&(e.qex(0),e.j41(1,"tr")(2,"th",4),e.EFF(3,"|"),e.k0s(),e.nrm(4,"th"),e.j41(5,"th",4),e.EFF(6,"|"),e.k0s(),e.nrm(7,"th"),e.j41(8,"th",4),e.EFF(9,"+"),e.k0s(),e.nrm(10,"th",8),e.j41(11,"th",4),e.EFF(12,"+"),e.k0s()(),e.j41(13,"tr")(14,"th",4),e.EFF(15,"|"),e.k0s(),e.nrm(16,"th"),e.j41(17,"th",4),e.EFF(18,"|"),e.k0s(),e.nrm(19,"th"),e.j41(20,"th",4),e.EFF(21,"|"),e.k0s(),e.j41(22,"th",14),e.EFF(23),e.k0s(),e.j41(24,"th",4),e.EFF(25,">"),e.k0s(),e.j41(26,"th",4),e.nrm(27,"app-category-evolution-input",15),e.k0s(),e.j41(28,"th",4),e.EFF(29,"|"),e.k0s()(),e.bVm()),2&a){const n=r.$implicit,t=e.XpG(2).$implicit,o=e.XpG().$implicit,l=e.XpG();e.R7$(23),e.JRh(n.name),e.R7$(4),e.Y8G("langFrom",l.langFrom)("langTo",l.langTo)("pos",o)("valueFrom",n)("valuesTo",l.getValuesTo(t))}}function b(a,r){if(1&a&&(e.qex(0),e.DNE(1,j,30,6,"ng-container",3),e.bVm()),2&a){const n=e.XpG().$implicit,t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.getValuesFrom(n))}}function k(a,r){if(1&a&&(e.qex(0),e.j41(1,"tr")(2,"th",4),e.EFF(3,"|"),e.k0s(),e.nrm(4,"th"),e.j41(5,"th",4),e.EFF(6,"+"),e.k0s(),e.nrm(7,"th",8),e.j41(8,"th",4),e.EFF(9,"+"),e.k0s(),e.nrm(10,"th",9),e.j41(11,"th",4),e.EFF(12,"+"),e.k0s()(),e.j41(13,"tr")(14,"th",4),e.EFF(15,"|"),e.k0s(),e.nrm(16,"th"),e.j41(17,"th",4),e.EFF(18,"|"),e.k0s(),e.j41(19,"th",10),e.EFF(20),e.k0s(),e.nrm(21,"th",11),e.j41(22,"th",4),e.EFF(23),e.k0s(),e.j41(24,"th",12),e.EFF(25),e.k0s(),e.j41(26,"th",4),e.EFF(27,"|"),e.k0s()(),e.DNE(28,b,2,1,"ng-container",13),e.bVm()),2&a){const n=r.$implicit,t=e.XpG().$implicit,o=e.XpG();e.R7$(20),e.JRh(n.name),e.R7$(3),e.JRh(o.getCategoryTo(t,n)?"":"|"),e.R7$(2),e.JRh(o.getCategoryTo(t,n)?"":"No grammatical category"),e.R7$(3),e.Y8G("ngIf",o.getCategoryTo(t,n))}}function I(a,r){if(1&a&&(e.qex(0),e.j41(1,"tr")(2,"th",4),e.EFF(3,"+"),e.k0s(),e.nrm(4,"th",5),e.j41(5,"th",4),e.EFF(6,"+"),e.k0s()(),e.j41(7,"tr")(8,"th",4),e.EFF(9,"|"),e.k0s(),e.j41(10,"th",6),e.EFF(11),e.k0s(),e.nrm(12,"th",7),e.j41(13,"th",4),e.EFF(14,"|"),e.k0s()(),e.DNE(15,k,29,4,"ng-container",3),e.bVm()),2&a){const n=r.$implicit,t=e.XpG();e.R7$(11),e.JRh(n.name),e.R7$(4),e.Y8G("ngForOf",t.getCategoriesFrom(n))}}let V=(()=>{class a{posService;categoryService;langFrom;langTo;poses=[];categoriesFrom=new Map;categoriesTo=new Map;valuesFrom=new Map;valuesTo=new Map;constructor(n,t){this.posService=n,this.categoryService=t}ngOnInit(){this.langFrom?.id&&this.langTo?.id&&this.reload(this.langFrom.id,this.langTo.id)}ngOnChanges(n){if(n.langFrom?.currentValue||n.langTo?.currentValue){let t,o;console.log("ngOnChanges",n),t=n.langFrom?.currentValue.id?n.langFrom.currentValue.id:this.langFrom?.id?this.langFrom?.id:0,o=n.langTo?.currentValue.id?n.langTo.currentValue.id:this.langTo?.id?this.langTo?.id:0,t&&o&&this.reload(t,o)}}reload(n,t){this.posService.getAllPosByLanguage({languageId:n}).subscribe(o=>{this.poses=o.sort((l,i)=>l.name?l.name.localeCompare(i.name?i.name:""):-1),this.poses.forEach(l=>this.reloadCategory(l,n,t))}),this.categoryService.getAllCategories().subscribe(o=>{this.valuesFrom.clear(),this.valuesTo.clear(),o.forEach(l=>{const i=l.id;i&&(this.categoryService.getCategoryValuesByCategoryAndLang({categoryId:i,langId:n}).subscribe(p=>this.valuesFrom.set(i,p)),this.categoryService.getCategoryValuesByCategoryAndLang({categoryId:i,langId:t}).subscribe(p=>this.valuesTo.set(i,p)))})})}reloadCategory(n,t,o){this.categoriesFrom.clear(),this.categoriesTo.clear(),n.id&&(this.categoryService.getGrammaticalCategoryConnectionsForLangAndPos({posId:n.id,languageId:t}).subscribe(l=>{n.id&&this.categoriesFrom.set(n.id,l.map(i=>i.grammaticalCategory?i.grammaticalCategory:{}))}),this.categoryService.getGrammaticalCategoryConnectionsForLangAndPos({posId:n.id,languageId:o}).subscribe(l=>{n.id&&this.categoriesTo.set(n.id,l.map(i=>i.grammaticalCategory?i.grammaticalCategory:{}))}))}getCategoriesFrom(n){return n.id?this.categoriesFrom.get(n.id):[]}getValuesFrom(n){return n.id?this.valuesFrom.get(n.id):[]}getValuesTo(n){return n.id?this.valuesTo.get(n.id):[]}getCategoryTo(n,t){if(n.id&&t.id)return this.categoriesTo.get(n.id)?.find(o=>o.id===t.id)}static \u0275fac=function(t){return new(t||a)(e.rXU(E.Q),e.rXU(y.M))};static \u0275cmp=e.VBU({type:a,selectors:[["app-category-evolution-table"]],inputs:{langFrom:"langFrom",langTo:"langTo"},standalone:!0,features:[e.OA$,e.aNF],decls:19,vars:1,consts:[["span","1",1,"border",2,"width","8px"],["span","1",2,"width","calc(25% - 40px)"],["span","1",2,"width","25%"],[4,"ngFor","ngForOf"],[1,"border"],["app-horizontal-dash","","colspan","7",1,"border"],[1,"text-grey"],["colspan","6",1,"border"],["app-horizontal-dash","","colspan","3",1,"border"],["app-horizontal-dash","","colspan","1",1,"border"],[1,"text-white"],["colspan","2",1,"border"],[1,"text-yellow-dull"],[4,"ngIf"],[1,"text-main"],[3,"langFrom","langTo","pos","valueFrom","valuesTo"]],template:function(t,o){1&t&&(e.j41(0,"table")(1,"colgroup"),e.nrm(2,"col",0)(3,"col",1)(4,"col",0)(5,"col",2)(6,"col",0)(7,"col",2)(8,"col",0)(9,"col",2)(10,"col",0),e.k0s(),e.j41(11,"tbody"),e.DNE(12,I,16,2,"ng-container",3),e.j41(13,"tr")(14,"th",4),e.EFF(15,"+"),e.k0s(),e.nrm(16,"th",5),e.j41(17,"th",4),e.EFF(18,"+"),e.k0s()()()()),2&t&&(e.R7$(12),e.Y8G("ngForOf",o.poses))},dependencies:[C,g.pM,g.bT,_.g]})}return a})();function x(a,r){if(1&a&&(e.j41(0,"option",9),e.EFF(1),e.k0s()),2&a){const n=r.$implicit,t=e.XpG();e.Y8G("ngValue",n),e.R7$(),e.JRh(t.getConnectionText(n))}}let G=(()=>{class a{languagesEvolutionService;connections=[];connection;constructor(n){this.languagesEvolutionService=n}ngOnInit(){this.languagesEvolutionService.getConnections().subscribe(n=>{this.connections=n.sort((t,o)=>{let l=0;return t.langFrom?.displayName&&o.langFrom?.displayName&&(l=t.langFrom?.displayName.localeCompare(o.langFrom.displayName)),!l&&t.langTo?.displayName&&o.langTo?.displayName&&(l=t.langTo?.displayName.localeCompare(o.langTo.displayName)),l})})}getConnectionText(n){return`${n.langFrom?.displayName} -> ${n.langTo?.displayName} (${this.getConnectionTypeText(n.connectionType)})`}getConnectionTypeText(n){switch(n){case u.L.Borrowing:return"Borrowing";case u.L.Evolving:return"Evolving";case u.L.Derivation:return"Derivation";default:return"Unknown connection"}}changeConnection(n){console.log("changeConnection",n.connection)}static \u0275fac=function(t){return new(t||a)(e.rXU(d.e))};static \u0275cmp=e.VBU({type:a,selectors:[["app-category-evolution"]],standalone:!0,features:[e.aNF],decls:35,vars:5,consts:[["span","1",1,"border",2,"width","8px"],["span","1",2,"width","auto"],["span","1",1,"border",2,"width","max-content"],[1,"border"],[2,"text-align","left","display","flex"],[1,"selector"],["for","languageSelector",1,"languageSelectorLabel"],[1,"input-group"],["id","languageSelector","name","languageSelector",1,"languageSelector",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"langFrom","langTo"]],template:function(t,o){1&t&&(e.j41(0,"table")(1,"colgroup"),e.nrm(2,"col",0)(3,"col",1)(4,"col",2)(5,"col",0),e.k0s(),e.j41(6,"tbody")(7,"tr")(8,"th",3),e.EFF(9,"|"),e.nrm(10,"br"),e.EFF(11,"|"),e.nrm(12,"br"),e.EFF(13,"|"),e.nrm(14,"br"),e.EFF(15,"|"),e.k0s(),e.j41(16,"th",4)(17,"div",5)(18,"label",6),e.EFF(19,"Languages connection"),e.k0s(),e.j41(20,"div",7)(21,"select",8),e.bIt("ngModelChange",function(i){return o.changeConnection({connection:i})}),e.mxI("ngModelChange",function(i){return e.DH7(o.connection,i)||(o.connection=i),i}),e.j41(22,"option",9),e.EFF(23," --- Select Connection ---"),e.k0s(),e.DNE(24,x,2,2,"option",10),e.k0s()()()(),e.nrm(25,"th",3),e.j41(26,"th",3),e.EFF(27,"|"),e.nrm(28,"br"),e.EFF(29,"|"),e.nrm(30,"br"),e.EFF(31,"|"),e.nrm(32,"br"),e.EFF(33,"|"),e.k0s()()()(),e.nrm(34,"app-category-evolution-table",11)),2&t&&(e.R7$(21),e.R50("ngModel",o.connection),e.R7$(),e.Y8G("ngValue",void 0),e.R7$(2),e.Y8G("ngForOf",o.connections),e.R7$(10),e.Y8G("langFrom",null==o.connection?null:o.connection.langFrom)("langTo",null==o.connection?null:o.connection.langTo))},dependencies:[V,s.YN,s.xH,s.y7,s.wz,s.BC,s.vS,g.Sq],styles:[".languageSelector[_ngcontent-%COMP%]{margin-top:4px}.languageSelectorLabel[_ngcontent-%COMP%]{margin-left:4px}"]})}return a})()}}]);